
<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>View Blogs - VOICE OF ELIZUBA</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="styles.css">
  <script src="main.js" defer></script>
  <script>
    document.addEventListener('DOMContentLoaded', ()=>{
      loadFirebaseAndInit(() => {
        const list = document.getElementById('blogList');
        db.collection('blogs').orderBy('createdAt','desc').get().then(snap=>{
          if(snap.empty){
            list.innerHTML = '<p class="small">No blogs yet. Admin can add blogs from admin panel.</p>';
            return;
          }
          snap.forEach(doc=>{
            const b = doc.data();
            const div = document.createElement('div');
            div.className='blog-card';
            div.innerHTML = `<h2>${escapeHtml(b.title)}</h2><p class="small">${escapeHtml(b.summary || '')}</p>
              <a class="btn" href="blog.html?id=${doc.id}">Open</a>`;
            list.appendChild(div);
          });
        }).catch(err=>{ console.error(err); list.innerHTML='<p class="small">Failed to load blogs.</p>'; });
      });
    });

    function escapeHtml(s){ return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;'); }
  </script>
</head>
<body>
  <div class="bg" style="background-image:url('viewblogbg.png')">
    <div class="container">
      <h1>All Blogs</h1>
      <div id="blogList"></div>
      <div class="home-link"><a class="btn" href="index.html">Home</a></div>
    </div>
  </div>
</body>
</html>
